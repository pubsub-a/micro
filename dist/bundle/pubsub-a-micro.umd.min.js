(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["PubSubMicro"]=factory();else root["PubSubMicro"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)if(!exports.hasOwnProperty(p))exports[p]=m[p]}var buckethash_1=__webpack_require__(1);exports.BucketHash=buckethash_1.BucketHash;var pubsub_micro_1=__webpack_require__(2);exports.PubSubMicroUnvalidated=pubsub_micro_1.PubSubMicroUnvalidated;exports.PubSub=pubsub_micro_1.PubSubMicroValidated;var subscription_token_1=__webpack_require__(6);exports.SubscriptionToken=subscription_token_1.SubscriptionToken;var validation_wrapper_1=__webpack_require__(7);exports.PubSubValidationWrapper=validation_wrapper_1.PubSubValidationWrapper;__export(__webpack_require__(8));var helper_1=__webpack_require__(9);exports.invokeIfDefined=helper_1.invokeIfDefined;exports.safeDispose=helper_1.safeDispose},function(module,exports){"use strict";var BucketHash=function(){function BucketHash(){this.dict={}}BucketHash.prototype.encodeKey=function(key){return"%"+key};BucketHash.prototype.decodeKey=function(key){return key.substr(1)};BucketHash.prototype.add=function(key,item){var dict=this.dict;var encodedKey=this.encodeKey(key);if(!dict.hasOwnProperty(encodedKey)){dict[encodedKey]=[item];return 1}else{dict[encodedKey].push(item);return dict[encodedKey].length}};BucketHash.prototype.get=function(key){var encodedKey=this.encodeKey(key);return this.dict[encodedKey]||[]};BucketHash.prototype.keys=function(){var result=[];for(var _i=0,_a=Object.keys(this.dict);_i<_a.length;_i++){var key=_a[_i];if(key[0]==="%"){var decodedKey=this.decodeKey(key);result.push(decodedKey)}}return result};BucketHash.prototype.exists=function(key){var encodedKey=this.encodeKey(key);return this.dict.hasOwnProperty(encodedKey)};BucketHash.prototype.clear=function(key){this.remove(key)};BucketHash.prototype.remove=function(key,item){var encodedKey=this.encodeKey(key);var bucket=this.dict[encodedKey];if(!bucket){if(!item){return 0}else{throw new Error("Key '"+key+"' does not exist")}}if(!item){delete this.dict[encodedKey];return 0}var index=this.removeFromArray(bucket,item);if(index===-1)throw new Error("Trying to remove non-existant element from the bucket");if(bucket.length===0)delete this.dict[encodedKey];return bucket.length};BucketHash.prototype.removeFromArray=function(arr,item){var index=arr.indexOf(item);if(index>=0)arr.splice(index,1);return index};return BucketHash}();exports.BucketHash=BucketHash},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var es6_promise_1=__webpack_require__(3);var buckethash_1=__webpack_require__(1);var subscription_token_1=__webpack_require__(6);var validation_wrapper_1=__webpack_require__(7);var helper_1=__webpack_require__(9);var PubSubMicroValidated=function(_super){__extends(PubSubMicroValidated,_super);function PubSubMicroValidated(){_super.call(this,new PubSubMicroUnvalidated)}return PubSubMicroValidated}(validation_wrapper_1.PubSubValidationWrapper);exports.PubSubMicroValidated=PubSubMicroValidated;var PubSubMicroUnvalidated=function(){function PubSubMicroUnvalidated(){this.isStopped=false;this.subscriptionCache=new buckethash_1.BucketHash}PubSubMicroUnvalidated.prototype.start=function(callback,disconnect){helper_1.invokeIfDefined(callback,this,undefined,undefined);return es6_promise_1.Promise.resolve(this)};PubSubMicroUnvalidated.prototype.stop=function(callback){this.isStopped=true;helper_1.invokeIfDefined(callback);return es6_promise_1.Promise.resolve(void 0)};PubSubMicroUnvalidated.prototype.channel=function(name,callback){var channel=new Channel(name,this);helper_1.invokeIfDefined(callback,channel);return es6_promise_1.Promise.resolve(channel)};return PubSubMicroUnvalidated}();exports.PubSubMicroUnvalidated=PubSubMicroUnvalidated;var Publisher=function(){function Publisher(encodedTopic,bucket){this.encodedTopic=encodedTopic;this.bucket=bucket}Publisher.prototype.publish=function(obj){var subs=this.bucket.get(this.encodedTopic);for(var _i=0,subs_1=subs;_i<subs_1.length;_i++){var observer=subs_1[_i];try{observer(obj)}catch(err){}}};return Publisher}();var Subscriber=function(){function Subscriber(encodedTopic,bucket){this.encodedTopic=encodedTopic;this.bucket=bucket}Subscriber.prototype.subscribe=function(observer){var _this=this;var number_of_subscriptions=this.bucket.add(this.encodedTopic,observer);var onDispose=function(callback){var remaining=_this.bucket.remove(_this.encodedTopic,observer);helper_1.invokeIfDefined(callback,remaining);return es6_promise_1.Promise.resolve(remaining)};return new subscription_token_1.SubscriptionToken(onDispose,number_of_subscriptions)};return Subscriber}();var Channel=function(){function Channel(name,pubsub){this.name=name;this.pubsub=pubsub}Object.defineProperty(Channel.prototype,"bucket",{get:function(){return this.pubsub.subscriptionCache},enumerable:true,configurable:true});Channel.prototype.encodeTopic=function(topic){var encodedTopic=this.name+"_%_"+topic;return encodedTopic};Channel.prototype.publish=function(topic,payload,callback){var publisher=new Publisher(this.encodeTopic(topic),this.bucket);publisher.publish(payload);helper_1.invokeIfDefined(callback,topic,payload);return es6_promise_1.Promise.resolve()};Channel.prototype.subscribe=function(topic,observer,callback){if(!observer){throw new Error("observer function must be given and be of type function")}var subscriber=new Subscriber(this.encodeTopic(topic),this.bucket);var subscription=subscriber.subscribe(observer);helper_1.invokeIfDefined(callback,subscription,topic,observer);return es6_promise_1.Promise.resolve(subscription)};Channel.prototype.once=function(topic,observer,callback){var promise;var alreadyRun=false;var subscribeAndDispose=function(payload){if(alreadyRun)return;alreadyRun=true;promise.then(function(subs){helper_1.safeDispose(subs)});observer(payload)}.bind(observer);promise=this.subscribe(topic,subscribeAndDispose,callback);return promise};return Channel}()},function(module,exports,__webpack_require__){var require;(function(process,global){(function(global,factory){true?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.ES6Promise=factory()})(this,function(){"use strict";function objectOrFunction(x){return typeof x==="function"||typeof x==="object"&&x!==null}function isFunction(x){return typeof x==="function"}var _isArray=undefined;if(!Array.isArray){_isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"}}else{_isArray=Array.isArray}var isArray=_isArray;var len=0;var vertxNext=undefined;var customSchedulerFn=undefined;var asap=function asap(callback,arg){queue[len]=callback;queue[len+1]=arg;len+=2;if(len===2){if(customSchedulerFn){customSchedulerFn(flush)}else{scheduleFlush()}}};function setScheduler(scheduleFn){customSchedulerFn=scheduleFn}function setAsap(asapFn){asap=asapFn}var browserWindow=typeof window!=="undefined"?window:undefined;var browserGlobal=browserWindow||{};var BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver;var isNode=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function useNextTick(){return function(){return process.nextTick(flush)}}function useVertxTimer(){return function(){vertxNext(flush)}}function useMutationObserver(){var iterations=0;var observer=new BrowserMutationObserver(flush);var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=flush;return function(){return channel.port2.postMessage(0)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}var queue=new Array(1e3);function flush(){for(var i=0;i<len;i+=2){var callback=queue[i];var arg=queue[i+1];callback(arg);queue[i]=undefined;queue[i+1]=undefined}len=0}function attemptVertx(){try{var r=require;var vertx=__webpack_require__(5);vertxNext=vertx.runOnLoop||vertx.runOnContext;return useVertxTimer()}catch(e){return useSetTimeout()}}var scheduleFlush=undefined;if(isNode){scheduleFlush=useNextTick()}else if(BrowserMutationObserver){scheduleFlush=useMutationObserver()}else if(isWorker){scheduleFlush=useMessageChannel()}else if(browserWindow===undefined&&"function"==="function"){scheduleFlush=attemptVertx()}else{scheduleFlush=useSetTimeout()}function then(onFulfillment,onRejection){var _arguments=arguments;var parent=this;var child=new this.constructor(noop);if(child[PROMISE_ID]===undefined){makePromise(child)}var _state=parent._state;if(_state){(function(){var callback=_arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})})()}else{subscribe(parent,child,onFulfillment,onRejection)}return child}function resolve(object){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===Constructor){return object}var promise=new Constructor(noop);_resolve(promise,object);return promise}var PROMISE_ID=Math.random().toString(36).substring(16);function noop(){}var PENDING=void 0;var FULFILLED=1;var REJECTED=2;var GET_THEN_ERROR=new ErrorObject;function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function getThen(promise){try{return promise.then}catch(error){GET_THEN_ERROR.error=error;return GET_THEN_ERROR}}function tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then){asap(function(promise){var sealed=false;var error=tryThen(then,thenable,function(value){if(sealed){return}sealed=true;if(thenable!==value){_resolve(promise,value)}else{fulfill(promise,value)}},function(reason){if(sealed){return}sealed=true;_reject(promise,reason)},"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;_reject(promise,error)}},promise)}function handleOwnThenable(promise,thenable){if(thenable._state===FULFILLED){fulfill(promise,thenable._result)}else if(thenable._state===REJECTED){_reject(promise,thenable._result)}else{subscribe(thenable,undefined,function(value){return _resolve(promise,value)},function(reason){return _reject(promise,reason)})}}function handleMaybeThenable(promise,maybeThenable,then$$){if(maybeThenable.constructor===promise.constructor&&then$$===then&&maybeThenable.constructor.resolve===resolve){handleOwnThenable(promise,maybeThenable)}else{if(then$$===GET_THEN_ERROR){_reject(promise,GET_THEN_ERROR.error)}else if(then$$===undefined){fulfill(promise,maybeThenable)}else if(isFunction(then$$)){handleForeignThenable(promise,maybeThenable,then$$)}else{fulfill(promise,maybeThenable)}}}function _resolve(promise,value){if(promise===value){_reject(promise,selfFulfillment())}else if(objectOrFunction(value)){handleMaybeThenable(promise,value,getThen(value))}else{fulfill(promise,value)}}function publishRejection(promise){if(promise._onerror){promise._onerror(promise._result)}publish(promise)}function fulfill(promise,value){if(promise._state!==PENDING){return}promise._result=value;promise._state=FULFILLED;if(promise._subscribers.length!==0){asap(publish,promise)}}function _reject(promise,reason){if(promise._state!==PENDING){return}promise._state=REJECTED;promise._result=reason;asap(publishRejection,promise)}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers;var length=_subscribers.length;parent._onerror=null;_subscribers[length]=child;_subscribers[length+FULFILLED]=onFulfillment;_subscribers[length+REJECTED]=onRejection;if(length===0&&parent._state){asap(publish,parent)}}function publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return}var child=undefined,callback=undefined,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){invokeCallback(settled,child,callback,detail)}else{callback(detail)}}promise._subscribers.length=0}function ErrorObject(){this.error=null}var TRY_CATCH_ERROR=new ErrorObject;function tryCatch(callback,detail){try{return callback(detail)}catch(e){TRY_CATCH_ERROR.error=e;return TRY_CATCH_ERROR}}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value=undefined,error=undefined,succeeded=undefined,failed=undefined;if(hasCallback){value=tryCatch(callback,detail);if(value===TRY_CATCH_ERROR){failed=true;error=value.error;value=null}else{succeeded=true}if(promise===value){_reject(promise,cannotReturnOwn());return}}else{value=detail;succeeded=true}if(promise._state!==PENDING){}else if(hasCallback&&succeeded){_resolve(promise,value)}else if(failed){_reject(promise,error)}else if(settled===FULFILLED){fulfill(promise,value)}else if(settled===REJECTED){_reject(promise,value)}}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){_resolve(promise,value)},function rejectPromise(reason){_reject(promise,reason)})}catch(e){_reject(promise,e)}}var id=0;function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++;promise._state=undefined;promise._result=undefined;promise._subscribers=[]}function Enumerator(Constructor,input){this._instanceConstructor=Constructor;this.promise=new Constructor(noop);if(!this.promise[PROMISE_ID]){makePromise(this.promise)}if(isArray(input)){this._input=input;this.length=input.length;this._remaining=input.length;this._result=new Array(this.length);if(this.length===0){fulfill(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){fulfill(this.promise,this._result)}}}else{_reject(this.promise,validationError())}}function validationError(){return new Error("Array Methods must be provided an Array")}Enumerator.prototype._enumerate=function(){var length=this.length;var _input=this._input;for(var i=0;this._state===PENDING&&i<length;i++){this._eachEntry(_input[i],i)}};Enumerator.prototype._eachEntry=function(entry,i){var c=this._instanceConstructor;var resolve$$=c.resolve;if(resolve$$===resolve){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING){this._settledAt(entry._state,i,entry._result)}else if(typeof _then!=="function"){this._remaining--;this._result[i]=entry}else if(c===Promise){var promise=new c(noop);handleMaybeThenable(promise,entry,_then);this._willSettleAt(promise,i)}else{this._willSettleAt(new c(function(resolve$$){return resolve$$(entry)}),i)}}else{this._willSettleAt(resolve$$(entry),i)}};Enumerator.prototype._settledAt=function(state,i,value){var promise=this.promise;if(promise._state===PENDING){this._remaining--;if(state===REJECTED){_reject(promise,value)}else{this._result[i]=value}}if(this._remaining===0){fulfill(promise,this._result)}};Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;subscribe(promise,undefined,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})};function all(entries){return new Enumerator(this,entries).promise}function race(entries){var Constructor=this;if(!isArray(entries)){return new Constructor(function(_,reject){return reject(new TypeError("You must pass an array to race."))})}else{return new Constructor(function(resolve,reject){var length=entries.length;for(var i=0;i<length;i++){Constructor.resolve(entries[i]).then(resolve,reject)}})}}function reject(reason){var Constructor=this;var promise=new Constructor(noop);_reject(promise,reason);return promise}function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Promise(resolver){this[PROMISE_ID]=nextId();this._result=this._state=undefined;this._subscribers=[];if(noop!==resolver){typeof resolver!=="function"&&needsResolver();this instanceof Promise?initializePromise(this,resolver):needsNew()}}Promise.all=all;Promise.race=race;Promise.resolve=resolve;Promise.reject=reject;Promise._setScheduler=setScheduler;Promise._setAsap=setAsap;Promise._asap=asap;Promise.prototype={constructor:Promise,then:then,"catch":function _catch(onRejection){return this.then(null,onRejection)}};function polyfill(){var local=undefined;if(typeof global!=="undefined"){local=global}else if(typeof self!=="undefined"){local=self}else{try{local=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if(promiseToString==="[object Promise]"&&!P.cast){return}}local.Promise=Promise}polyfill();Promise.polyfill=polyfill;Promise.Promise=Promise;return Promise})}).call(exports,__webpack_require__(4),function(){return this}())},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},function(module,exports){},function(module,exports){"use strict";var SubscriptionToken=function(){function SubscriptionToken(onDispose,count){this.isDisposed=false;this.disposeFn=onDispose;this.count=count?count:0}SubscriptionToken.prototype.dispose=function(callback){if(this.isDisposed){throw new Error("Subscription is already disposed")}this.isDisposed=true;return this.disposeFn(callback)};return SubscriptionToken}();exports.SubscriptionToken=SubscriptionToken},function(module,exports,__webpack_require__){"use strict";var es6_promise_1=__webpack_require__(3);var string_validation_1=__webpack_require__(8);var helper_1=__webpack_require__(9);var PubSubValidationWrapper=function(){function PubSubValidationWrapper(wrappedPubSub){this.enablePlainObjectCheck=true;this.isStopped=false;this.pubsub=wrappedPubSub;this.stringValidator=new string_validation_1.DefaultTopicChannelNameValidator}PubSubValidationWrapper.prototype.setTopicChannelNameSettings=function(settings){this.stringValidator=new string_validation_1.DefaultTopicChannelNameValidator(settings)};PubSubValidationWrapper.prototype.start=function(callback,onStopByExternal){if(this.isStopped){var err="Already stopped, can't restart. You need to create a new instance";helper_1.invokeIfDefined(callback,this,err);return es6_promise_1.Promise.reject("Already stopped, can't restart. You need to create a new instance")}return this.pubsub.start(callback,onStopByExternal)};PubSubValidationWrapper.prototype.stop=function(callback){this.isStopped=true;return this.pubsub.stop(callback)};PubSubValidationWrapper.prototype.channel=function(name,callback){var _this=this;if(this.isStopped){var err="Instance is stopped";return es6_promise_1.Promise.reject(new Error(err))}if(typeof name!=="string")throw new Error("Channel name must be of type string");if(name=="")throw new Error("Channel name must be non-zerolength string");this.stringValidator.validateChannelName(name);var wrappedCallback;if(callback){wrappedCallback=function(chan){var wrappedChannel=new ChannelValidated(name,chan,_this);callback(wrappedChannel)}}return new es6_promise_1.Promise(function(resolve,reject){_this.pubsub.channel(name,wrappedCallback).then(function(chan){var channel=new ChannelValidated(name,chan,_this);resolve(channel)})})};return PubSubValidationWrapper}();exports.PubSubValidationWrapper=PubSubValidationWrapper;var ChannelValidated=function(){function ChannelValidated(name,wrappedChannel,pubsub){this.name=name;this.wrappedChannel=wrappedChannel;this.pubsub=pubsub;this.stringValidator=pubsub.stringValidator;this.enablePlainObjectCheck=pubsub.enablePlainObjectCheck}ChannelValidated.prototype.objectIsPlainObject=function(obj){if(typeof obj=="object"&&obj.constructor!=Object){return false}else{return true}};ChannelValidated.prototype.setTopicChannelNameValidator=function(validator){this.stringValidator=validator};ChannelValidated.prototype.publish=function(topic,payload,callback){if(typeof topic!=="string"||topic=="")throw new Error("topic must be a non-zerolength string, was: "+topic);if(this.enablePlainObjectCheck&&!this.objectIsPlainObject(payload)){var err=new Error("only plain objects are allowed to be published");throw err}if(this.pubsub.isStopped){var err=new Error("pubsub has stopped");helper_1.invokeIfDefined(callback,err);return es6_promise_1.Promise.reject(err)}this.stringValidator.validateTopicName(topic);return this.wrappedChannel.publish(topic,payload,callback)};ChannelValidated.prototype.subscribe=function(topic,observer,callback){if(typeof topic!=="string"||topic=="")throw new Error("topic must be a non-zerolength string, was: "+topic);this.stringValidator.validateTopicName(topic);if(this.pubsub.isStopped){var err=new Error("pubsub has stoped");helper_1.invokeIfDefined(callback,undefined,undefined,err);return es6_promise_1.Promise.reject(err)}return this.wrappedChannel.subscribe(topic,observer,callback)};ChannelValidated.prototype.once=function(topic,observer,callback){if(typeof topic!=="string"||topic=="")throw new Error("topic must be a non-zerolength string");this.stringValidator.validateTopicName(topic);return this.wrappedChannel.once(topic,observer,callback)};return ChannelValidated}()},function(module,exports){"use strict";var DefaultTopicChannelNameValidator=function(){function DefaultTopicChannelNameValidator(settings){if(!settings){settings={channelNameMaxLength:63,topicNameMaxLength:255}}this.settings=settings}DefaultTopicChannelNameValidator.prototype.containsOnlyValidChars=function(name){var m=name.match(/([A-z0-9_:\/\-]+)/g);var contains_invalid_chars=m==null||m==undefined||m.length==0||m[0]!==name;return!contains_invalid_chars};DefaultTopicChannelNameValidator.prototype.validateChannelName=function(name){if(name.length>this.settings.channelNameMaxLength)throw new Error("Channel name must be between 1 and "+this.settings.channelNameMaxLength+" characters long");if(!this.containsOnlyValidChars(name)){throw new Error("Channel name contains invalid characters")}};DefaultTopicChannelNameValidator.prototype.validateTopicName=function(name){if(name.length>this.settings.topicNameMaxLength)throw new Error("Topic name must be between 1 and "+this.settings.topicNameMaxLength+" characters long");if(this.containsOnlyValidChars(name))return;var repl=name;repl=repl.replace(/_\$_/g,"");repl=repl.replace(/_%_/g,"");if(!this.containsOnlyValidChars(repl))throw new Error("Topic name contains unallowed character(s): "+name)};return DefaultTopicChannelNameValidator}();exports.DefaultTopicChannelNameValidator=DefaultTopicChannelNameValidator},function(module,exports,__webpack_require__){"use strict";var es6_promise_1=__webpack_require__(3);function safeDispose(token){if(!token)throw new Error("token must be defined!");if(!token.isDisposed)return token.dispose();else return es6_promise_1.Promise.resolve(undefined)}exports.safeDispose=safeDispose;function invokeIfDefined(func){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}if(func){func.apply(func,args)}}exports.invokeIfDefined=invokeIfDefined}])});